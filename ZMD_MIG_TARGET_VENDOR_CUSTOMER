*--------------------------------------------------------------------*
* 이관 대상 거래처 추출
*--------------------------------------------------------------------*
*<Start>
DATA : BEGIN OF LS_LIFNR,
  LIFNR TYPE LIFNR,
  KUNNR TYPE KUNNR,
  END OF LS_LIFNR.

DATA : LT_LIFNR LIKE TABLE OF LS_LIFNR.

DATA : BEGIN OF LS_KUNNR,
  LIFNR TYPE LIFNR,
  KUNNR TYPE KUNNR,
  END OF LS_KUNNR.

DATA : LT_KUNNR LIKE TABLE OF LS_KUNNR.
**--- Vendor
" 영업 문서-공급업체
SELECT A~LIFNR
  APPENDING CORRESPONDING FIELDS OF TABLE LT_LIFNR
  FROM LFA1 AS A INNER JOIN VBAK AS B
  ON A~LIFNR = B~KUNNR
  WHERE B~AUDAT BETWEEN '20230101' AND '20251231'
  AND A~LOEVM = SPACE.


" 구매 문서-공급업체
SELECT A~LIFNR
  APPENDING CORRESPONDING FIELDS OF TABLE LT_LIFNR
  FROM LFA1 AS A INNER JOIN EKKO AS B
  ON A~LIFNR = B~LIFNR
  WHERE B~BEDAT BETWEEN '20230101' AND '20251231'
  AND A~LOEVM = SPACE.

" 회계 문서-공급업체
SELECT A~LIFNR
  APPENDING CORRESPONDING FIELDS OF TABLE LT_LIFNR
  FROM BSEG AS A
  WHERE A~GJAHR  BETWEEN '2023' AND '2025'
  AND A~LIFNR NE SPACE.

" 구매처 미결-공급업체
SELECT A~LIFNR
  APPENDING CORRESPONDING FIELDS OF TABLE LT_LIFNR
  FROM LFA1 AS A INNER JOIN BSIK AS B
  ON A~LIFNR = B~LIFNR
  WHERE B~BUDAT BETWEEN '20230101' AND '20251231'
  AND A~LOEVM = SPACE.

" 판매처 미결-공급업체
SELECT A~LIFNR
  APPENDING CORRESPONDING FIELDS OF TABLE LT_LIFNR
  FROM LFA1 AS A INNER JOIN BSID AS B
  ON A~LIFNR = B~KUNNR
  WHERE B~BUDAT BETWEEN '20230101' AND '20251231'
  AND A~LOEVM = SPACE.

**--- Customer
" 영업 문서-공급업체
SELECT A~KUNNR
  APPENDING CORRESPONDING FIELDS OF TABLE LT_KUNNR
  FROM KNA1 AS A INNER JOIN VBAK AS B
  ON A~KUNNR = B~KUNNR
  WHERE B~AUDAT BETWEEN '20230101' AND '20251231'
  AND A~LOEVM = SPACE.


" 구매 문서-고객
SELECT A~KUNNR
  APPENDING CORRESPONDING FIELDS OF TABLE LT_KUNNR
  FROM KNA1 AS A INNER JOIN EKKO AS B
  ON A~KUNNR = B~LIFNR
  WHERE B~BEDAT BETWEEN '20230101' AND '20251231'
  AND A~LOEVM = SPACE.

" 회계 문서-고객
SELECT A~KUNNR
  APPENDING CORRESPONDING FIELDS OF TABLE LT_KUNNR
  FROM BSEG AS A
  WHERE A~GJAHR  BETWEEN '2023' AND '2025'
  AND A~KUNNR NE SPACE.

" 구매처 미결-고객
SELECT A~KUNNR
  APPENDING CORRESPONDING FIELDS OF TABLE LT_KUNNR
  FROM KNA1 AS A INNER JOIN BSIK AS B
  ON A~KUNNR = B~LIFNR
  WHERE B~BUDAT BETWEEN '20230101' AND '20251231'
  AND A~LOEVM = SPACE.

" 판매처 미결-고객
SELECT A~KUNNR
  APPENDING CORRESPONDING FIELDS OF TABLE LT_KUNNR
  FROM KNA1 AS A INNER JOIN BSID AS B
  ON A~KUNNR = B~KUNNR
  WHERE B~BUDAT BETWEEN '20230101' AND '20251231'
  AND A~LOEVM = SPACE.

  SORT LT_LIFNR BY LIFNR.
  DELETE ADJACENT DUPLICATES FROM LT_LIFNR COMPARING LIFNR.
  SORT LT_KUNNR BY KUNNR.
  DELETE ADJACENT DUPLICATES FROM LT_KUNNR COMPARING KUNNR.

  BREAK-POINT.
*<End>
*--------------------------------------------------------------------*
